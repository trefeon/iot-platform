persistence true
persistence_location /mosquitto/data/
log_dest file /mosquitto/log/mosquitto.log

# Authentication settings (applies to all listeners)
# For development you may set allow_anonymous true (not recommended for production)
allow_anonymous false
password_file /mosquitto/config/passwd
acl_file /mosquitto/config/aclfile

# TCP listener for LAN devices (ESP32, etc.)
listener 1883

# WebSocket listener for browsers via Cloudflare (no raw 1883 on internet)
listener 9001
protocol websockets

# TLS example (uncomment & provide certs for direct access)
# listener 8883
# cafile /mosquitto/config/ca.crt
# certfile /mosquitto/config/server.crt
# keyfile /mosquitto/config/server.key
